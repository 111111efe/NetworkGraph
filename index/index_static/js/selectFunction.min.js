function selectNode(e){d3.select(this).classed("finded",false);if(d3.event.which==3){stopLayout()}e.selected=true;d3.select(this).classed("selected",true)}function selectNodes(s){var n=data.nodes.filter(function(e,t){return e.selected});var d=[];if(s===2){data.links.forEach(function(e,t){if(n.indexOf(e.target)>-1){e.source.selected=false;d.push(e.source)}})}data.links.forEach(function(e,t){if(n.indexOf(e.target)>-1&&s==0){e.source.selected=true}else if(n.indexOf(e.source)>-1&&s==1){e.target.selected=true}else if(d.indexOf(e.source)>-1&&s==2){e.target.selected=true}else if(n.indexOf(e.source)>-1&&s==3){e.target.selected=true}else if(n.indexOf(e.target)>-1&&s==3){e.source.selected=true}});refreshState()}function refreshState(){node_elements.each(function(e){if(e.selected==true){d3.select(this).classed("selected",true)}})}data.nodes.forEach(function(e){e.selected=false;e.previouslySelected=false});var brush_event=d3.brush().extent([[0,0],[window.innerWidth,window.innerHeight]]).on("start",brushStarted).on("brush",brushed).on("end",brushEnded);brush_svg.call(brush_event);function brushStarted(){if(d3.event.sourceEvent.type!=="end"){node_elements.classed("selected",false);data.nodes.forEach(function(e){e.selected=false})}}function brushed(){if(d3.event.sourceEvent.type!=="end"){var t=d3.event.selection;node_elements.classed("selected",function(e){return e.selected=e.previouslySelected^(t!=null&&t[0][0]<=e.x&&e.x<t[1][0]&&t[0][1]<=e.y&&e.y<t[1][1])})}}function brushEnded(){if(d3.event.selection!=null){d3.select(this).call(d3.event.target.move,null)}}